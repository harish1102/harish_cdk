CREATE TABLE iam_policies (
    id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    policy_document CLOB,
    CONSTRAINT policy_json CHECK (policy_document IS JSON)
);
-----
DECLARE
    l_blob BLOB;
    l_clob CLOB;
BEGIN
    -- Load the BLOB from a file (Assuming the file is accessible by the Oracle server)
    l_blob := BFILENAME('YOUR_DIRECTORY', 'your_iam_policy.json');
    DBMS_LOB.fileopen(l_blob, DBMS_LOB.file_readonly);
    DBMS_LOB.createtemporary(l_clob, true);
    DBMS_LOB.loadfromfile(l_clob, l_blob, DBMS_LOB.getlength(l_blob));
    DBMS_LOB.fileclose(l_blob);

    -- Insert into your table
    INSERT INTO iam_policies (policy_document) VALUES (l_clob);
    COMMIT;
END;
-----
SELECT p.id,
       JSON_VALUE(p.policy_document, '$.Statement[0].Effect') AS effect,
       JSON_QUERY(p.policy_document, '$.Statement[0].Action') AS action
FROM iam_policies p
WHERE JSON_EXISTS(p.policy_document, '$.Statement[0]')
-----
